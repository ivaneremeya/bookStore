"use strict";(self.webpackChunkproxyclient=self.webpackChunkproxyclient||[]).push([[570],{7862:(e,r,a)=>{a.d(r,{A:()=>t});a(5043);const t=a.p+"static/media/book-2-svgrepo-com.a102b1200a61f1a1ea86d67d5995c39a.svg"},4611:(e,r,a)=>{a.d(r,{d:()=>s});var t=a(5043);const s=(e,r)=>{const a=t.useRef(null),s=t.useCallback((t=>{clearTimeout(a.current),a.current=setTimeout((()=>{e(t)}),r)}),[e,r]);return t.useEffect((()=>{clearTimeout(a.current)}),[]),s}},1570:(e,r,a)=>{a.r(r),a.d(r,{default:()=>y});var t=a(5043),s=a(4117),c=a(9559),i=a(6946),d=a(1249),l=a(3896),o=a(4611),n=a(7862),m=a(5377);var u=a(579);const p=e=>{let{id:r,amount:a}=e;const[c,i]=t.useState(String(a)),[p,h]=t.useState(a),[x,g]=t.useState(0),{t:j}=(0,s.Bd)(["cartPage","error"]),b=(0,d.j)(),k=(0,o.d)((e=>{b((0,l.I)({book_id:r,amount:e,errorMessage:j("error:cartPatchError")}))}),300);t.useEffect((()=>{(async()=>{const e=await(async e=>(await m.gI.get("/api/books/".concat(e,"/"))).data)(r);g(e.in_stock)})()}),[r]),console.log(x,"stockBook");const v=e=>{x>=e&&(h(e),i(String(e)),k(e))},y=Number(c)<=1;return(0,u.jsxs)("div",{className:"product",children:[(0,u.jsx)("div",{className:"product-image",children:(0,u.jsx)("img",{src:n.A,alt:"Logo"})}),(0,u.jsx)("div",{className:"product-details",children:(0,u.jsx)("div",{className:"product-title",children:"Samuel Rios"})}),(0,u.jsx)("div",{className:"product-removal",children:(0,u.jsx)("p",{className:"stok-product",children:x})}),(0,u.jsxs)("div",{className:"product-quantity",children:[(0,u.jsx)("button",{type:"button",onClick:()=>v(p-1),disabled:y,className:"qt-minus",children:"-"}),(0,u.jsx)("input",{type:"number",value:c,onChange:e=>{const{value:r}=e.target;let a=Number(r);Number.isNaN(a)?""===r&&(i(""),h(0)):(a=a>x?x:a,i(String(a)),h(a),a>0&&k(a))},onKeyDown:e=>{"-"!==e.key&&"+"!==e.key&&","!==e.key&&"."!==e.key||e.preventDefault()},className:"qt",max:x}),(0,u.jsx)("button",{type:"button",onClick:()=>v(p+1),className:"qt-plus",children:"+"})]}),(0,u.jsx)("div",{className:"product-removal",children:(0,u.jsx)("button",{type:"button",onClick:()=>b((0,l.I)({book_id:r,amount:0,errorMessage:j("error:cartPatchError")})),className:"remove-product",children:j("cartPage:cartPageRemove")})})]})};var h=a(4858),x=a(4698);var g=a(6120),j=a(1387),b=a(5934);const k=(0,g.zD)("order/makeOrder",(async(e,r)=>{try{const a=await m.gI.post("api/cart/make_order/",{city:e.city,address:e.address,zipcode:e.zipcode});return r.dispatch((0,b.Nb)({title:"success",descr:e.errorMessage,isVizible:!0})),setTimeout((()=>{(0,j.V2)("/BooksList")}),1500),a.data}catch(a){return r.dispatch((0,b.Nb)({title:"error",descr:e.errorMessage,isVizible:!0})),r.rejectWithValue(a)}})),v=()=>{const e=(0,d.j)(),r=(0,d.G)((e=>e.zipcodeError)),{t:a}=(0,s.Bd)(["makeOrderModal","error"]),{register:t,formState:{errors:c},handleSubmit:i,reset:l}=(0,h.mN)();return(0,u.jsx)("div",{className:"cart-order",children:(0,u.jsx)("div",{className:"cart__wrapper",children:(0,u.jsx)("div",{className:"cart__container",children:(0,u.jsxs)("form",{onSubmit:i((r=>{const t=a("error:makeOrder");e(k({...r,errorMessage:t})),l()})),children:[(0,u.jsxs)("h1",{children:[" ",a("makeOrderModal:makeOrderModalDetail")]}),(0,u.jsxs)("div",{className:"name",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"city",children:[a("makeOrderModal:makeOrderModalCity"),(0,u.jsx)("input",{id:"city",type:"text",...t("city",{required:!0,minLength:1})})]}),c.city&&(0,u.jsx)("span",{style:{color:"red"},role:"alert",children:"This field is required"})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"address",children:[a("makeOrderModal:makeOrderModalAdress"),(0,u.jsx)("input",{id:"address",type:"text",...t("address",{required:!0,minLength:1})})]}),c.address&&(0,u.jsx)("span",{style:{color:"red"},role:"alert",children:"This field is required"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"zipcode",children:[a("makeOrderModal:makeOrderModalZicope"),(0,u.jsx)("input",{id:"zipcode",type:"text",...t("zipcode",{required:!0,minLength:1,onBlur:async r=>{const a=r.target.value;a&&await(async(e,r)=>{try{const a=await m.gI.get("api/cart/check_zipcode/",{params:{zipcode:e}});return r((0,x.v)("")),a.data.is_valid}catch(a){const t="Error validating zipcode: ".concat(e);return r((0,x.v)(t)),!1}})(Number(a),e)}})})]}),c.zipcode&&(0,u.jsx)("span",{style:{color:"red"},role:"alert",children:"This field is required"}),r&&(0,u.jsx)("span",{style:{color:"red"},role:"alert",children:r})]}),(0,u.jsx)("div",{className:"btns",children:(0,u.jsx)("button",{type:"submit",children:a("makeOrderModal:makeOrderModalMaking")})})]})})})})},y=()=>{const[e,r]=t.useState(!1),{t:a}=(0,s.Bd)(["cartPage"]),l=(0,d.G)((e=>e.cart.item)),o=(0,d.G)((e=>e.cart.totalPrice));return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("h1",{style:{textAlign:"center"},children:a("cartPage:cartPageTitle")}),(0,u.jsxs)("div",{className:"shopping-cart",children:[(0,u.jsxs)("div",{className:"column-labels",children:[(0,u.jsx)("span",{style:{textAlign:"center"},className:"product-image",children:a("cartPage:cartPageImage")}),(0,u.jsx)("span",{className:"product-details",children:a("cartPage:cartPageProduct")}),(0,u.jsxs)("span",{className:"stok-product",children:[" ",a("cartPage:cartPageStock")," "]}),(0,u.jsx)("span",{className:"product-quantity",children:a("cartPage:cartPageQuantity")}),(0,u.jsx)("span",{className:"product-removal",children:a("cartPage:cartPageRemove")})]}),l.map((e=>(0,u.jsx)(p,{id:e.book_id,amount:e.amount},e.id))),(0,u.jsx)("div",{className:"totals",children:(0,u.jsxs)("div",{className:"totals-item totals-item-total",children:[(0,u.jsxs)("span",{children:[" ",a("cartPage:cartPagePrice")]}),(0,u.jsx)("div",{className:"totals-value",id:"cart-total",children:o})]})}),(0,u.jsx)("button",{type:"button",className:"checkout",onClick:()=>r(!0),children:a("cartPage:cartPageCheckout")}),(0,u.jsx)(c.A,{open:e,onClose:()=>r(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,u.jsx)(i.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24},children:(0,u.jsx)(v,{})})})]})]})}}}]);
//# sourceMappingURL=570.11ff0246.chunk.js.map